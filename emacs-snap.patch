diff --git a/usr/share/emacs/29.0.90/lisp/emacs-lisp/comp.el b/usr/share/emacs/29.0.90/lisp/emacs-lisp/comp.el
index e97832455b9..b04cfa00c33 100644
--- a/usr/share/emacs/29.0.90/lisp/emacs-lisp/comp.el
+++ b/usr/share/emacs/29.0.90/lisp/emacs-lisp/comp.el
@@ -186,8 +186,7 @@ and above."
   :type '(repeat string)
   :version "28.1")
 
-(defcustom native-comp-driver-options (when (eq system-type 'darwin)
-                                        '("-Wl,-w"))
+(defcustom native-comp-driver-options (when (getenv "SNAP") (list (concat "--sysroot=" (file-name-as-directory (getenv "SNAP"))) (concat "-B" (file-name-as-directory (getenv "SNAP")) "usr/lib/gcc/")))
   "Options passed verbatim to the native compiler's back-end driver.
 Note that not all options are meaningful; typically only the options
 affecting the assembler and linker are likely to be useful.
diff --git a/usr/share/emacs/29.0.90/lisp/treesit.el b/usr/share/emacs/29.0.90/lisp/treesit.el
index e718ea1a23a..3a313c613ee 100644
--- a/usr/share/emacs/29.0.90/lisp/treesit.el
+++ b/usr/share/emacs/29.0.90/lisp/treesit.el
@@ -2932,11 +2932,11 @@ function signals an error."
          (default-directory (make-temp-file "treesit-workdir" t))
          (workdir (expand-file-name "repo"))
          (source-dir (expand-file-name (or source-dir "src") workdir))
-         (cc (or cc (seq-find #'executable-find '("cc" "gcc" "c99"))
+         (cc (or cc (concat (file-name-as-directory (getenv "SNAP")) "usr/bin/gcc-10")
                  ;; If no C compiler found, just use cc and let
                  ;; `call-process' signal the error.
                  "cc"))
-         (c++ (or c++ (seq-find #'executable-find '("c++" "g++"))
+         (c++ (or c++ (concat (file-name-as-directory (getenv "SNAP")) "usr/bin/g++-10")
                   "c++"))
          (soext (or (car dynamic-library-suffixes)
                     (signal 'treesit-error '("Emacs cannot figure out the file extension for dynamic libraries for this system, because `dynamic-library-suffixes' is nil"))))
